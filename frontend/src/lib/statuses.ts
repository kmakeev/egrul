export type StatusOption = {
  code: string;
  label: string;
};

// Статусы для юридических лиц (ЕГРЮЛ)
export const companyStatusOptions: StatusOption[] = [
  { code: "101", label: "Находится в стадии ликвидации" },
  {
    code: "105",
    label:
      "Регистрирующим органом принято решение о предстоящем исключении юридического лица из ЕГРЮЛ (недействующее юридическое лицо)",
  },
  {
    code: "106",
    label:
      "Регистрирующим органом принято решение о предстоящем исключении юридического лица из ЕГРЮЛ (невозможность ликвидации юридического лица)",
  },
  {
    code: "107",
    label:
      "Регистрирующим органом принято решение о предстоящем исключении юридического лица из ЕГРЮЛ (наличие в ЕГРЮЛ сведений о юридическом лице, в отношении которых внесена запись о недостоверности)",
  },
  {
    code: "111",
    label: "Юридическое лицо находится в процессе уменьшения уставного капитала",
  },
  {
    code: "112",
    label: "Юридическим лицом принято решение об изменении места нахождения",
  },
  {
    code: "113",
    label:
      "В отношении юридического лица возбуждено производство по делу о несостоятельности (банкротстве)",
  },
  {
    code: "114",
    label:
      "В отношении юридического лица в деле о несостоятельности (банкротстве) введено наблюдение",
  },
  {
    code: "115",
    label:
      "В отношении юридического лица в деле о несостоятельности (банкротстве) введено финансовое оздоровление",
  },
  {
    code: "116",
    label:
      "В отношении юридического лица в деле о несостоятельности (банкротстве) введено внешнее управление",
  },
  {
    code: "117",
    label:
      "Юридическое лицо признано несостоятельным (банкротом) и в отношении него открыто конкурсное производство",
  },
  {
    code: "121",
    label: "Находится в процессе реорганизации в форме преобразования",
  },
  {
    code: "122",
    label: "Находится в процессе реорганизации в форме слияния",
  },
  {
    code: "123",
    label: "Находится в процессе реорганизации в форме разделения",
  },
  {
    code: "124",
    label:
      "Находится в процессе реорганизации в форме присоединения к другому юридическому лицу",
  },
  {
    code: "129",
    label:
      "Находится в процессе реорганизации при одновременном сочетании различных форм реорганизации и прекратит деятельность при ее завершении",
  },
  {
    code: "131",
    label: "Находится в процессе реорганизации в форме выделения",
  },
  {
    code: "132",
    label:
      "Находится в процессе реорганизации в форме присоединения к нему других юридических лиц",
  },
  {
    code: "134",
    label:
      "Находится в процессе реорганизации в форме присоединения, осуществляемой одновременно с выделением",
  },
  {
    code: "136",
    label:
      "Находится в процессе реорганизации в форме выделения, осуществляемой одновременно с присоединением",
  },
  {
    code: "139",
    label:
      "Находится в процессе реорганизации при одновременном сочетании различных форм реорганизации и прекратит деятельность при ее завершении",
  },
  {
    code: "701",
    label:
      "Государственная регистрация юридического лица признана недействительной по решению суда",
  },
  {
    code: "702",
    label:
      "Внесение в ЕГРЮЛ сведений о юридическом лице, зарегистрированном до 01.07.2002, признано недействительным по решению суда",
  },
  {
    code: "801",
    label:
      "Внесение записи о государственной регистрации юридического лица признано ошибочным по решению регистрирующего органа",
  },
];

// Статусы для индивидуальных предпринимателей (ЕГРИП)
export const entrepreneurStatusOptions: StatusOption[] = [
  {
    code: "101",
    label:
      "Глава крестьянского (фермерского) хозяйства отсутствует в связи со смертью",
  },
  {
    code: "103",
    label:
      "Глава крестьянского (фермерского) хозяйства отсутствует в связи с аннулированием документа, подтверждающего право временно или постоянно проживать в Российской Федерации",
  },
  {
    code: "104",
    label:
      "Глава крестьянского (фермерского) хозяйства отсутствует в связи с окончанием срока действия документа, подтверждающего право временно или постоянно проживать в Российской Федерации",
  },
  {
    code: "110",
    label:
      "Принято решение о предстоящем исключении недействующего ИП из ЕГРИП",
  },
  {
    code: "701",
    label:
      "Государственная регистрация физического лица в качестве индивидуального предпринимателя признана недействительной по решению суда",
  },
  {
    code: "702",
    label:
      "Государственная регистрация крестьянского (фермерского) хозяйства признана недействительной по решению суда",
  },
  {
    code: "801",
    label:
      "Внесение записи о государственной регистрации физического лица в качестве индивидуального предпринимателя признано ошибочным по решению регистрирующего органа",
  },
  {
    code: "802",
    label:
      "Внесение записи о государственной регистрации крестьянского (фермерского) хозяйства признано ошибочным по решению регистрирующего органа",
  },
];

// Объединённый список статусов для единого выпадающего списка.
// Если код совпадает у ЮЛ и ИП, текстовые описания объединяются через запятую.
export const unifiedStatusOptions: StatusOption[] = (() => {
  const map = new Map<string, Set<string>>();

  const addOptions = (options: StatusOption[]) => {
    for (const opt of options) {
      if (!map.has(opt.code)) {
        map.set(opt.code, new Set<string>());
      }
      map.get(opt.code)!.add(opt.label);
    }
  };

  addOptions(companyStatusOptions);
  addOptions(entrepreneurStatusOptions);

  const result: StatusOption[] = [];
  for (const [code, labelsSet] of map.entries()) {
    const labels = Array.from(labelsSet.values());
    result.push({
      code,
      label: labels.join(", "),
    });
  }

  // Сортировка по возрастанию кода (как числа, но с безопасным fallback).
  result.sort((a, b) => {
    const na = Number(a.code);
    const nb = Number(b.code);
    if (Number.isFinite(na) && Number.isFinite(nb)) {
      return na - nb;
    }
    return a.code.localeCompare(b.code);
  });

  return result;
})();

